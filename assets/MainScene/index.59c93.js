window.__require=function t(e,o,i){function n(s,r){if(!o[s]){if(!e[s]){var l=s.split("/");if(l=l[l.length-1],!e[l]){var c="function"==typeof __require&&__require;if(!r&&c)return c(l,!0);if(a)return a(l,!0);throw new Error("Cannot find module '"+s+"'")}s=l}var p=o[s]={exports:{}};e[s][0].call(p.exports,function(t){return n(e[s][1][t]||t)},p,p.exports,t,e,o,i)}return o[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<i.length;s++)n(i[s]);return n}({GameDirector:[function(t,e,o){"use strict";cc._RF.push(e,"6d088A7nYNLd6wJkhsMlfmq","GameDirector");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/yyComponent"),r=t("../../Script/GameSpecial/GameEventType"),l=t("../../Script/Common/Action3dManager"),c=t("../../Script/Common/UIManager"),p=t("../../Script/Common/PlayerData"),h=t("../../Script/Common/AudioManager"),u=t("../../Script/Common/GameData"),d=t("../../Script/Common/PowerManager"),y=t("../../Script/Common/Loader"),v=t("../../Script/GameSpecial/GlobalEnum"),f=t("../../Script/Advert/AdvertManager"),m=t("../../Script/Common/GlobalPool"),g=t("../../Script/GameSpecial/GameOwn"),S=cc._decorator,b=S.ccclass,E=S.property,G=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.touchMask=null,e.defaultUIs=[],e.lobbyUIs=[],e.levelUIs=[],e.persistUIs=[],e.levelMng=null,e.uiActMng=null,e.recommendFlowStepFinish=!1,e.chosedLevel=null,e}return n(e,t),e.prototype.onLoad=function(){var t=cc.director.getPhysicsManager();t.enabled=!0,t.enabledAccumulator=!0,t.FIXED_TIME_STEP=1/30},e.prototype.start=function(){this.init(),this.loadGameData()},e.prototype.update=function(t){this.uiActMng.update(t),this.customUpdate(t)},e.prototype.initTouchMask=function(){this.touchMask.active=!1,this.touchMaskCount=0},e.prototype.resetTouchMask=function(){this.touchMask.active=!1,this.touchMaskCount=0},e.prototype.showTouchMask=function(t){void 0===t&&(t=1),this.touchMaskCount+=t,this.touchMask.active=!0},e.prototype.hideTouchMask=function(t){void 0===t&&(t=1),this.touchMaskCount-=t,this.touchMaskCount<=0&&(this.touchMaskCount=0,this.touchMask.active=!1)},e.prototype.pauseLevel=function(){this.emit(r.EventType.DirectorEvent.pauseLevel)},e.prototype.resumeLevel=function(){this.emit(r.EventType.DirectorEvent.resumeLevel)},e.prototype.showUI=function(t,e){this.emit(r.EventType.UIEvent.enter,t,e)},e.prototype.showUIs=function(t){for(var e=t.length-1;e>=0;--e)this.emit(r.EventType.UIEvent.enter,t[e])},e.prototype.hideUI=function(t){this.emit(r.EventType.UIEvent.exit,t)},e.prototype.hideUIs=function(t){for(var e=t.length-1;e>=0;--e)this.emit(r.EventType.UIEvent.exit,t[e])},e.prototype.initDefaultUIs=function(){for(var t=this.defaultUIs.length-1;t>=0;--t)this.defaultUIs[t].init()},e.prototype.initUIConfig=function(){this.lobbyUIs=[],this.lobbyUIs.push(v.GlobalEnum.UI.lobby),this.lobbyUIs.push(v.GlobalEnum.UI.shop),this.lobbyUIs.push(v.GlobalEnum.UI.chooseLevel),this.lobbyUIs.push(v.GlobalEnum.UI.touchBanner),this.lobbyUIs.push(v.GlobalEnum.UI.signIn),this.levelUIs=[],this.levelUIs.push(v.GlobalEnum.UI.levelInfo),this.levelUIs.push(v.GlobalEnum.UI.levelController),this.levelUIs.push(v.GlobalEnum.UI.levelTeach),this.levelUIs.push(v.GlobalEnum.UI.awardUI),this.levelUIs.push(v.GlobalEnum.UI.winUI),this.levelUIs.push(v.GlobalEnum.UI.loseUI),this.levelUIs.push(v.GlobalEnum.UI.trySkin),this.levelUIs.push(v.GlobalEnum.UI.pauseLevel),this.levelUIs.push(v.GlobalEnum.UI.resurgence),this.levelUIs.push(v.GlobalEnum.UI.touchBanner),this.persistUIs=[],this.persistUIs.push(v.GlobalEnum.UI.playerAssetBar),this.persistUIs.push(v.GlobalEnum.UI.tipPower),this.persistUIs.push(v.GlobalEnum.UI.getPower),this.persistUIs.push(v.GlobalEnum.UI.configSetting)},e.prototype.initActMng=function(){this.uiActMng=l.default.getMng(l.ActionMngType.UI)},e.prototype.init=function(){this.initUIConfig(),this.initActMng(),this.initTouchMask(),this.initModels(),this.initDefaultUIs(),this.initCustomUpdateState(),this.registAllCustomUpdate(),this.onEvents()},e.prototype.initModels=function(){f.default.init(),c.default.init(this.node.getChildByName("UI")),h.default.init(),u.default.init(),d.default.init()},e.prototype.onEvents=function(){this.on(r.EventType.DirectorEvent.enterLevel,this.onEnterLevel,this),this.on(r.EventType.DirectorEvent.enterLobby,this.enterGameLobby,this),this.on(r.EventType.DirectorEvent.playerWin,this.onLevelWin,this),this.on(r.EventType.DirectorEvent.playerLose,this.onLevelLose,this),this.on(r.EventType.DirectorEvent.hideGameLobby,this.hideGameLobbyUI,this),this.on(r.EventType.UIEvent.showTouchMask,this.showTouchMask,this),this.on(r.EventType.UIEvent.hideTouchMask,this.hideTouchMask,this),this.on(r.EventType.LevelEvent.resurgence,this.onResurgence,this),this.on(r.EventType.GameFlow.enterLevel,this.onEnterGameFlowLevel,this)},e.prototype.registAllCustomUpdate=function(){this.registCustomUpdate(v.GlobalEnum.DirectState.level,this.stepLevelPlaying)},e.prototype.reset=function(){this.levelMng&&this.levelMng.exit(),this.resetTouchMask(),this.resetCustomUpdateState()},e.prototype.loadGameData=function(){var t=this;y.default.loadBundleDir("MainScene","JSONData",function(e){for(var o=[],i=0,n=e.length;i<n;++i)o.push(e[i].name);u.default.setData(e,o),t.emit(r.EventType.DirectorEvent.enterLobby),t.enterCustomUpdateState(v.GlobalEnum.DirectState.lobby)},cc.JsonAsset,!1)},e.prototype.enterGameLobby=function(){this.levelMng&&this.levelMng.exit(),this.hideUIs(this.levelUIs),this.hideUIs(this.persistUIs),this.showUI(v.GlobalEnum.UI.lobby);var t=p.default.getData("gameData.signIn.allDays"),e=p.default.getData("gameData.signIn.lastDay"),o=(new Date).getDate();t<7&&e!=o&&this.emit(r.EventType.UIEvent.enter,v.GlobalEnum.UI.signIn),this.enterCustomUpdateState(v.GlobalEnum.DirectState.lobby)},e.prototype.hideGameLobbyUI=function(){this.hideUIs(this.lobbyUIs),this.hideUIs(this.persistUIs),this.hideUI(v.GlobalEnum.UI.lobby),this.hideUI(v.GlobalEnum.UI.playerAssetBar)},e.prototype.onEnterLevel=function(t){this.chosedLevel=t,this.levelMng||this.loadLevelScene(),this.emit(r.EventType.GameFlow.enterLevel)},e.prototype.getCurLevel=function(){return p.default.getData("gameData.curLevel")},e.prototype.showTrySkin=function(){this.pauseLevel(),this.showUI(v.GlobalEnum.UI.trySkin,v.GlobalEnum.GoodsType.playerSkin)},e.prototype.loadLevelScene=function(){var t=this;y.default.loadBundle("LevelScene",function(){y.default.loadBundleDir("LevelScene","MultiplePrefab",function(e){for(var o=e.length-1;o>=0;--o){var i=e[o];m.default.createPool(i.name,i,i.name)}y.default.loadBundleRes("LevelScene","SinglePrefab/LevelManager",function(e){if(!t.levelMng){var o=cc.instantiate(e);t.node.getChildByName("LevelManager").addChild(o),t.levelMng=o.getComponent("LevelManager"),t.levelMng.init()}t.onLoadLevelFinish(),y.default.loadBundle("LevelUI",function(){y.default.loadBundleArray("LevelUI",["AwardUI/AwardUI","WinUI/WinUI","LoseUI/LoseUI"],function(){},cc.Prefab,!1)},!1,!1)},cc.Prefab,!0)},cc.Prefab,!0)},!0,!0)},e.prototype.onLoadLevelFinish=function(){this.checkEnterLevelScene()},e.prototype.onEnterGameFlowLevel=function(){this.recommendFlowStepFinish=!0,this.checkEnterLevelScene()},e.prototype.checkEnterLevelScene=function(){this.levelMng&&this.recommendFlowStepFinish&&(this.recommendFlowStepFinish=!1,this.once(g.default.Events.trySkinOver,this.enterLevelScene,this),this.emit(r.EventType.UIEvent.enter,v.GlobalEnum.UI.trySkin))},e.prototype.enterLevelScene=function(t){if(this.levelData){var e=this.levelData;this.levelData=null,this.chosedLevel=null,this._enterLevelScene(e)}else void 0===t&&(t=this.chosedLevel?this.chosedLevel:this.getCurLevel()),this.chosedLevel=null,u.default.getLevelData(t,this._enterLevelScene.bind(this))},e.prototype._enterLevelScene=function(t){this.hideGameLobbyUI(),this.hideUIs(this.levelUIs),this.levelMng.enterLevel(t),this.showUI(v.GlobalEnum.UI.levelInfo,t),this.enterCustomUpdateState(v.GlobalEnum.DirectState.level)},e.prototype.foreLoadLevelData=function(t){u.default.getLevelData(t,this.saveLevelData.bind(this))},e.prototype.saveLevelData=function(t){null!==this.chosedLevel&&(this.levelData=t)},e.prototype.onLevelWin=function(t){t||(t=c.default.getUI(v.GlobalEnum.UI.levelInfo).getData()),this.winData=t,this.addCurLevel(t),c.default.existUI(v.GlobalEnum.UI.awardUI)?this.emit(r.EventType.UIEvent.enter,v.GlobalEnum.UI.awardUI,{data:this.winData}):this.emit(r.EventType.UIEvent.enter,v.GlobalEnum.UI.winUI,{data:this.winData})},e.prototype.addCurLevel=function(t){var e=p.default.getData("gameData.curLevel");console.log("\u901a\u5173\u5f53\u524d\u5173\u5361\uff0c\u89e3\u9501\u4e0b\u4e00\u5173\uff0ccurLevel:",e," totalLevel:",32),t.lv===e&&e+1<=32?this.emit(r.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.curLevel",value:1,mode:"+"}):console.log("\u5173\u5361\u8d85\u7eb2")},e.prototype.updateLevelRecord=function(t){if(void 0!==t.star){var e=p.default.getData("gameData.levelRecords");(!e[t.lv]||e[t.lv]<t.star)&&(e[t.lv]=t.star,this.emit(r.EventType.PlayerDataEvent.updatePlayerData,{attribute:"gameData.levelRecords",value:e,mode:"=",save:!0,emit:!1}))}},e.prototype.onLevelLose=function(t){t||(t=c.default.getUI(v.GlobalEnum.UI.levelInfo).getData()),this.loseData=t,this.emit(r.EventType.UIEvent.enter,v.GlobalEnum.UI.loseUI,{data:this.loseData})},e.prototype.onResurgence=function(){this.hideUIs(this.lobbyUIs),this.hideUI(v.GlobalEnum.UI.playerAssetBar)},e.prototype.stepLevelPlaying=function(t){this.levelMng.running(t)},a([E(cc.Node)],e.prototype,"bg",void 0),a([E(cc.Node)],e.prototype,"touchMask",void 0),a([E([s.default])],e.prototype,"defaultUIs",void 0),a([b],e)}(s.default);o.default=G,cc._RF.pop()},{"../../Script/Advert/AdvertManager":void 0,"../../Script/Common/Action3dManager":void 0,"../../Script/Common/AudioManager":void 0,"../../Script/Common/GameData":void 0,"../../Script/Common/GlobalPool":void 0,"../../Script/Common/Loader":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/PowerManager":void 0,"../../Script/Common/UIManager":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GameOwn":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],GameLobby:[function(t,e,o){"use strict";cc._RF.push(e,"69ef72xiQlAL4AzHd4vX34+","GameLobby");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/yyComponent"),r=t("../../Script/GameSpecial/GlobalEnum"),l=t("../../Script/GameSpecial/GameEventType"),c=t("../../Script/GameSpecial/GameConfig"),p=t("../../Script/Common/Action3dManager"),h=t("../../Script/Common/Loader"),u=t("../../Script/Common/PlayerData"),d=t("../../Script/Common/GlobalPool"),y=t("./ShowPlace"),v=cc._decorator,f=v.ccclass,m=v.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._uiType=r.GlobalEnum.UI.lobby,e.btnAudio=null,e.audioOpen=null,e.audioClose=null,e.btnStartGame=null,e.chosedLevel=null,e.chooseLevel=null,e.btnMoreGame=null,e.moreGameTipIcon=null,e.BtnSignIn=null,e.showPlace=null,e}return n(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return this._uiType},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this;this.initBtnAudio(),this.onEvents(),setTimeout(function(){t.showPlace.init()},1e3)},e.prototype.onEvents=function(){this.on(l.EventType.LevelEvent.choseLevelItem,this.onChoseLevelItem,this)},e.prototype.show=function(){this.node.active=!0,console.log("\u8fdb\u5165\u6e38\u620f\u9996\u9875"),this.emit(l.EventType.AudioEvent.playBGM,r.GlobalEnum.AudioClip.BGM,!0),this.playMoreGameTip(),this.emit(l.EventType.UIEvent.enter,r.GlobalEnum.UI.playerAssetBar),this.updateBtnMoreGame(),this.showPlace.show(),this.updateBtnSignIn()},e.prototype.hide=function(){this.reset(),this.stopMoreGameTip(),this.node.active=!1,this.emit(l.EventType.UIEvent.exit,r.GlobalEnum.UI.playerAssetBar),this.showPlace.hide()},e.prototype.initBtnAudio=function(){this.btnAudio.node.on("touchend",this.onBtnAudio,this);var t=c.default.audioConfig.bgm;this.btnAudio.spriteFrame=t?this.audioOpen:this.audioClose},e.prototype.onBtnAudio=function(){var t=c.default.audioConfig.bgm,e={bgm:t=!t,effect:t};c.default.audioConfig=e,t?(this.btnAudio.spriteFrame=this.audioOpen,this.emit(l.EventType.AudioEvent.resume)):(this.btnAudio.spriteFrame=this.audioClose,this.emit(l.EventType.AudioEvent.pause))},e.prototype.playBtnStartGame=function(){var t=.97;this.btnStartGame.setScale(t,t),t=1.03;var e=p.default.scaleTo(.5,t,t,t);t=.97;var o=p.default.scaleTo(.5,t,t,t),i=p.default.sequence(e,o),n=p.default.repeatForever(i);p.default.getMng(p.ActionMngType.UI).runAction(this.btnStartGame,n)},e.prototype.stopBtnStartGame=function(){p.default.getMng(p.ActionMngType.UI).stopAllActions(this.btnStartGame)},e.prototype.onBtnStartGame=function(){this.emit(l.EventType.AudioEvent.playClickBtn),this.startGame()},e.prototype.startGame=function(){this._startGame()},e.prototype._startGame=function(){var t=this.chosedLevel;this.chosedLevel=null,this.emit(l.EventType.DirectorEvent.enterLevel,t)},e.prototype.onBtnChooseLevel=function(){this.emit(l.EventType.AudioEvent.playClickBtn),this.emit(l.EventType.UIEvent.enter,r.GlobalEnum.UI.chooseLevel)},e.prototype.onChoseLevelItem=function(t){this.chosedLevel=t,this.startGame(),this.emit(l.EventType.UIEvent.exit,r.GlobalEnum.UI.chooseLevel)},e.prototype.initChooseLevel=function(){this.chooseLevel?this.chooseLevel.init():this.loadChooseLevel()},e.prototype.setChooseLevel=function(){var t,e=this;t=u.default.getData("gameData.curLevel"),this.chooseLevel?this.chooseLevel.setData({nowlv:t,maxLv:24}):this.loadChooseLevel(function(){e.chooseLevel.setData({nowlv:t,maxLv:24})})},e.prototype.getTotalLevel=function(){var t=cc.sys.localStorage.getItem("levelDataVersion"),e=8;return t&&(e=JSON.parse(t).total,console.log("LVMAX",e)),e},e.prototype.hideChooseLevel=function(){this.chooseLevel.hide()},e.prototype.loadChooseLevel=function(t){var e=this;h.default.loadBundle("LobbyUI",function(){h.default.loadBundleRes("LobbyUI","ChooseLevelUI/LvBox",function(o){d.default.createPool(o.name,o,o.name),h.default.loadBundleRes("LobbyUI","ChooseLevelUI/ChooseLevel",function(o){if(!e.chooseLevel){var i=cc.instantiate(o);e.node.getChildByName("ChooseLevelUI").addChild(i),e.chooseLevel=i.getComponent("ChooseLevel"),e.chooseLevel.init()}t&&setTimeout(function(){t()},0)},cc.Prefab,!0)},cc.Prefab,!0)},!0,!0)},e.prototype.updateBtnMoreGame=function(){c.default[r.GlobalEnum.GameFlowGlobalConfig.guoshen]?this.btnMoreGame.active=!1:this.btnMoreGame.active=!0},e.prototype.updateBtnSignIn=function(){var t=u.default.getData("gameData.signIn.allDays");this.BtnSignIn.node.active=!(t>=7)},e.prototype.playMoreGameTip=function(){var t=.9;this.moreGameTipIcon.setScale(t,t,t),t=1.1,p.default.scaleTo(1,t,t,t),t=.9,p.default.scaleTo(1,t,t,t);var e=p.default.rotateTo2d(.1,30),o=p.default.rotateTo2d(.8,0),i=p.default.delay(2);o.easing(p.default.easeElasticOut());var n=p.default.sequence(i,e,o),a=p.default.repeatForever(n);p.default.getMng(p.ActionMngType.UI).runAction(this.moreGameTipIcon,a)},e.prototype.stopMoreGameTip=function(){p.default.getMng(p.ActionMngType.UI).stopAllActions(this.moreGameTipIcon)},e.prototype.onBtnMoreGame=function(){this.emit(l.EventType.RecommendEvent.showBigPage)},e.prototype.onBtnShop=function(){this.emit(l.EventType.AudioEvent.playClickBtn),this.emit(l.EventType.UIEvent.enter,r.GlobalEnum.UI.shop)},e.prototype.onBtnSignIn=function(){this.emit(l.EventType.AudioEvent.playClickBtn),this.emit(l.EventType.UIEvent.enter,r.GlobalEnum.UI.signIn)},a([m(cc.Sprite)],e.prototype,"btnAudio",void 0),a([m(cc.SpriteFrame)],e.prototype,"audioOpen",void 0),a([m(cc.SpriteFrame)],e.prototype,"audioClose",void 0),a([m(cc.Node)],e.prototype,"btnStartGame",void 0),a([m(cc.Node)],e.prototype,"btnMoreGame",void 0),a([m(cc.Node)],e.prototype,"moreGameTipIcon",void 0),a([m(cc.Button)],e.prototype,"BtnSignIn",void 0),a([m(y.default)],e.prototype,"showPlace",void 0),a([f],e)}(s.default);o.default=g,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/GlobalPool":void 0,"../../Script/Common/Loader":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameConfig":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0,"./ShowPlace":"ShowPlace"}],LevelController:[function(t,e,o){"use strict";cc._RF.push(e,"40bcc/o5rtGMK5aKqyYxbY2","LevelController");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/yyComponent"),r=t("../../Script/GameSpecial/GameEventType"),l=t("../../Script/GameSpecial/GlobalEnum"),c=cc._decorator,p=c.ccclass,h=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){this.init(),this.setDisable()},e.prototype.init=function(){this.initComponents(),this.initTouchState(),this.initCustomUpdateState(),this.registAllCustomUpdate(),this.onEvents()},e.prototype.onEvents=function(){this.node.on("touchstart",this.onTouchStart,this),this.node.on("touchmove",this.onTouchMove,this),this.node.on("touchend",this.onTouchEnd,this),this.on(r.EventType.CtrlEvent.ctrlStart,this.setEnable,this),this.on(r.EventType.CtrlEvent.ctrlEnd,this.setDisable,this)},e.prototype.registAllCustomUpdate=function(){this.registCustomUpdate(l.GlobalEnum.CtrlState.touched,this.stepTouchStay)},e.prototype.reset=function(){this.resetTouchState()},e.prototype.setEnable=function(){this.reset(),this.node.active=!0},e.prototype.setDisable=function(){this.reset(),this.node.active=!1},e.prototype.getTouchData=function(t){return{startTime:this.touchStartTime,stayTime:this.touchStayTime,path:this.touchPath,e:t}},e.prototype.initTouchState=function(){this.touched=!1,this.touchId=-1,this.touchStartTime=-1,this.touchStayTime=0,this.touchPath=[]},e.prototype.resetTouchState=function(){this.touched=!1,this.touchId=-1,this.touchStartTime=-1,this.touchStayTime=0,this.touchPath=[]},e.prototype.onTouchStart=function(t){if(!this.isMultipleTouch(t)){this.touched=!0,this.touchId=t.getID(),this.touchStartTime=Date.now(),this.touchStayTime=0;var e=t.getLocation();this.touchPath[0]=e,this.emit(r.EventType.CtrlEvent.touchStart,this.getTouchData(t)),this.enterCustomUpdateState(l.GlobalEnum.CtrlState.touched)}},e.prototype.onTouchMove=function(t){if(this.isCurTouchEvent(t)){var e=t.getLocation();this.touchPath[1]=e,this.emit(r.EventType.CtrlEvent.touchMove,this.getTouchData(t))}},e.prototype.onTouchEnd=function(t){if(this.isCurTouchEvent(t)){var e=t.getLocation();this.touchPath[1]=e,this.emit(r.EventType.CtrlEvent.touchEnd,this.getTouchData(t)),this.resetTouchState(),this.enterCustomUpdateState(l.GlobalEnum.CtrlState.none)}},e.prototype.isMultipleTouch=function(t){return t.getTouches().length>1},e.prototype.isCurTouchEvent=function(t){return t.getID()==this.touchId},e.prototype.stepTouchStay=function(t){this.touched&&(this.touchStayTime+=t,this.emit(r.EventType.CtrlEvent.touchStay,this.getTouchData(null)))},a([p],e)}(s.default));o.default=h,cc._RF.pop()},{"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],LoadingUI:[function(t,e,o){"use strict";cc._RF.push(e,"326d3l9GUNNN6sC8bQK7+Ik","LoadingUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/yyComponent"),r=t("../../Script/GameSpecial/GameEventType"),l=cc._decorator,c=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bar=null,e.totalLength=0,e.preRate=0,e}return n(e,t),e.prototype.init=function(){0==this.totalLength&&(this.totalLength=this.bar.getComponent(cc.Sprite).spriteFrame.getOriginalSize().width),this.bar.setPosition(-.5*this.totalLength,this.bar.y),this.preRate=0,this.onEvents()},e.prototype.onEvents=function(){this.on(r.EventType.LoadAssetEvent.showProgress,this.onShowProgress,this),this.on(r.EventType.LoadAssetEvent.updateProgress,this.onUpdateProgress,this),this.on(r.EventType.LoadAssetEvent.hideProgress,this.onHideProgress,this)},e.prototype.onShowProgress=function(t){this.node.active=!0,void 0===t&&(t=0),t<this.preRate&&(t=this.preRate),this.bar.width=this.totalLength*t,this.preRate=t},e.prototype.onUpdateProgress=function(t){1!=t?t>this.preRate&&(this.bar.width=this.totalLength*t,this.preRate=t):this.preRate=0},e.prototype.onHideProgress=function(){this.node.active=!1,this.preRate=0},a([p(cc.Node)],e.prototype,"bar",void 0),a([p],e.prototype,"totalLength",void 0),a([c],e)}(s.default);o.default=h,cc._RF.pop()},{"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0}],PlayerAssetBar:[function(t,e,o){"use strict";cc._RF.push(e,"08b7fQRKfNDVZa5QgqRT/Gw","PlayerAssetBar");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/yyComponent"),r=t("../../Script/GameSpecial/GameEventType"),l=t("../../Script/Common/PlayerData"),c=t("../../Script/Common/GlobalPool"),p=t("../../Script/GameSpecial/GlobalEnum"),h=t("../../Script/Common/Action3dManager"),u=cc._decorator,d=u.ccclass,y=u.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.goldLabel=null,e.goldLayer=null,e.goldIconPrefab=null,e}return n(e,t),e.prototype.init=function(){this.initComponents(),this.initGoldIcon(),this.onEvents(),this.setData()},e.prototype.onEvents=function(){this.on(r.EventType.PlayerDataEvent.playerDataChanged,this.onPlayerDataChanged,this),this.on(r.EventType.UIEvent.playGoldAnim,this.playGoldAnim,this)},e.prototype.reset=function(){this.resetGoldIcon()},e.prototype.show=function(){this.node.active=!0,this.setData(),this.onEvents()},e.prototype.hide=function(){this.offEvents(),this.node.active=!1},e.prototype.setData=function(){var t=l.default.getData("gameData.asset");this.setGold(t.gold)},e.prototype.convertToString=function(t){return t<1100?t.toString():t<1e6?(.001*t).toFixed(1)+"K":(1e-6*t).toFixed(1)+"M"},e.prototype.onPlayerDataChanged=function(t){switch(t.attribute){case"gameData.asset.gold":this.setGold(t.value)}},e.prototype.setGold=function(t){this.goldLabel.string=this.convertToString(t)},e.prototype.initGoldIcon=function(){var t=this.goldLabel.node.convertToWorldSpaceAR(cc.v2(0,0));t=this.node.convertToNodeSpaceAR(t),this.targetPos=cc.v3(t.x,t.y,0),this.cb=null,c.default.createPool(p.GlobalEnum.LevelPrefab.goldIcon,this.goldIconPrefab)},e.prototype.resetGoldIcon=function(){this.cb=null;for(var t=h.default.getMng(h.ActionMngType.UI),e=this.goldLayer.childrenCount-1;e>=0;--e)t.stopAllActions(this.goldLayer.children[e]);c.default.putAllChildren(this.goldLayer,!0)},e.prototype.playGoldAnim=function(t){this.resetGoldIcon(),this.emit(r.EventType.UIEvent.showTouchMask),this.cb=t.cb;var e=cc.v2();t.startPos&&e.set(t.startPos);for(var o=Math.round(10*Math.random())+20,i=h.default.getMng(h.ActionMngType.UI),n=0;n<o;n++){var a=c.default.get(p.GlobalEnum.LevelPrefab.goldIcon);this.goldLayer.addChild(a),a.setPosition(e),a.setScale(1,1);var s=h.default.moveTo(.2,80*(Math.random()-.5)+e.x,80*(Math.random()-.5)+e.y,0);s.easing(h.default.easeOut(2)),i.runAction(a,s)}this.scheduleOnce(this.toTarget,.2)},e.prototype.toTarget=function(){var t=h.default.getMng(h.ActionMngType.UI),e=.005*this.goldLayer.childrenCount,o=this.goldLabel.node.convertToWorldSpaceAR(cc.v2(0,0));o=this.node.convertToNodeSpaceAR(o);for(var i=this.goldLayer.childrenCount-1;i>=0;--i){var n=h.default.moveTo(.8,o.x,o.y,0),a=h.default.scaleTo(.8,.5,.5,1),s=h.default.spawn(n,a),r=h.default.delay(.005+.005*i),l=h.default.sequence(r,s);t.runAction(this.goldLayer.children[i],l)}this.scheduleOnce(this.playFinish,.8+e)},e.prototype.playFinish=function(){this.emit(r.EventType.UIEvent.hideTouchMask),this.cb?this.cb():this.emit(r.EventType.UIEvent.goldAnimPlayFinish),this.resetGoldIcon()},a([y(cc.Label)],e.prototype,"goldLabel",void 0),a([y(cc.Node)],e.prototype,"goldLayer",void 0),a([y(cc.Prefab)],e.prototype,"goldIconPrefab",void 0),a([d],e)}(s.default);o.default=v,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/GlobalPool":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],RoleShow:[function(t,e,o){"use strict";cc._RF.push(e,"b61b0aCKklLSbQp3qNaBc+n","RoleShow");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/GameData"),r=t("../../Script/Common/yyComponent"),l=t("../../Script/GameSpecial/GameOwn"),c=t("../../Script/GameSpecial/GlobalEnum"),p=cc._decorator,h=p.ccclass,u=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.raritySpr=null,e.roleSpr=null,e.lock=null,e.using=null,e.signIn=null,e.goldNode=null,e.goldLab=null,e.id=null,e}return n(e,t),e.prototype.init=function(t){this.reset(),t&&this.setData(t)},e.prototype.reuse=function(t){this.reset(),t&&this.setData(t)},e.prototype.unuse=function(){this.reset()},e.prototype.reset=function(){this.node.active=!1,this.lock.active=!1,this.using.active=!1,this.goldNode.active=!1,this.signIn.active=!1},e.prototype.setData=function(t){if(this.node.active=!0,this.id=t.id,this.raritySpr.spriteFrame=t.rarityImg,this.roleSpr.spriteFrame=t.roleImg,t.own)this.lock.active=!1,t.using?this.using.active=!0:this.using.active=!1;else{this.lock.active=!0;var e=s.default.getData(c.GlobalEnum.GameDataType.skinData,this.id);"gold"==e.cost.type?(this.goldNode.active=!0,this.goldLab.string=e.cost.value):"signIn"==e.cost.type&&(this.signIn.active=!0)}},e.prototype.owned=function(){this.node.active=!0,this.lock.active=!1,this.goldNode.active=!1,this.signIn.active=!1},e.prototype.pitchOn=function(){this.lock.active||(this.using.active=!0)},e.prototype.noPitchOn=function(){this.using.active=!1},e.prototype.signInGet=function(){this.signIn.active=!0},e.prototype.onbtnChoose=function(){this.emit(l.default.Events.chooseRole,this.id),console.log("\u9009\u8fd9\u4e2a"+this.id)},a([u(cc.Sprite)],e.prototype,"raritySpr",void 0),a([u(cc.Sprite)],e.prototype,"roleSpr",void 0),a([u(cc.Node)],e.prototype,"lock",void 0),a([u(cc.Node)],e.prototype,"using",void 0),a([u(cc.Node)],e.prototype,"signIn",void 0),a([u(cc.Node)],e.prototype,"goldNode",void 0),a([u(cc.Label)],e.prototype,"goldLab",void 0),a([h],e)}(r.default);o.default=d,cc._RF.pop()},{"../../Script/Common/GameData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameOwn":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],Role:[function(t,e,o){"use strict";cc._RF.push(e,"1817cImgTZLtYHpsOCKeGKW","Role");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/GameData"),r=t("../../Script/Common/GlobalPool"),l=t("../../Script/GameSpecial/CollisComp"),c=t("../../Script/GameSpecial/GameEventType"),p=t("../../Script/GameSpecial/GameOwn"),h=t("../../Script/GameSpecial/GlobalEnum"),u=cc._decorator,d=u.ccclass,y=u.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.head=null,e.body=null,e.armAndHand=[],e.weapom=null,e.weapomID=null,e.baseATK=0,e.MaxLife=100,e.life=100,e.energy=100,e.critNode=null,e.vector=cc.v2(),e.jumpFlag=!1,e}return n(e,t),e.prototype.init=function(){this.initScr(),this.onEvents()},e.prototype.reuse=function(){this.onEvents()},e.prototype.unuse=function(){this.customStep=this.stepEmpty,this.offEvents(),this.energy=100,this.body.node.setPosition(cc.v2(0,0)),this.weapom&&this.weapom.node&&(r.default.put(this.weapom.node),this.weapom=null),this.reset(),console.log("\u5bf9\u8c61\u88ab\u653e\u56de\u5bf9\u8c61\u6c60\uff0c\u8c03\u7528unuse")},e.prototype.reset=function(){this.body&&this.body.reset(),this.head&&this.head.reset(),0!=this.armAndHand.length&&(this.armAndHand[0].reset(),this.armAndHand[1].reset(),this.armAndHand[2].reset())},e.prototype.setData=function(e){this.customStep=this.dtUp,t.prototype.setData.call(this,e),e.type&&this.setgroup(e.type),this.body.setData(e),this.head.setData(e),this.armAndHand[0].setData(e),this.armAndHand[1].setData(e),this.armAndHand[2].setData(e),this.id=e.skinData.id,this.MaxLife=e.skinData.baseHP,this.life=this.MaxLife,this.baseATK=e.skinData.baseATK,"UI"==e.type||"default"==e.type?this.body.setStatic():this.body.setDynamic()},e.prototype.initScr=function(){this.head=this.node.getChildByName("head").getComponent(l.default),this.head.init(),this.body=this.node.getChildByName("body").getComponent(l.default),this.body.init();var t=this.node.getChildByName("arm1").getComponent(l.default);t.init();var e=this.node.getChildByName("arm2").getComponent(l.default);e.init();var o=this.node.getChildByName("hand").getComponent(l.default);o.init(),this.armAndHand.push(t,e,o)},e.prototype.setWeapom=function(t){this.weapomID=t;var e="Weapom_"+t,o=r.default.get(e);o.parent=this.node,o.setPosition(cc.v2(0,0)),this.weapom&&this.weapom.node&&r.default.put(this.weapom.node),this.weapom=o.getComponent(l.default),this.weapom.init(),this.weapom.setData({type:this.node.group});var i=this.node.getChildByName("hand").getComponent(cc.RigidBody);this.weapom.setJoint(i);var n=s.default.getData(h.GlobalEnum.GameDataType.WeapomData,t);this.weapom.employ({baseATK:n.baseATK+this.baseATK})},e.prototype.onEvents=function(){this.on(p.default.Events.beInjured,this.beinjured,this),this.on(p.default.Events.controlAIASK,this.controlAnswer,this)},e.prototype.offEvents=function(){this.off(p.default.Events.beInjured,this.beinjured,this),this.off(p.default.Events.controlAIASK,this.controlAnswer,this)},e.prototype.controlAnswer=function(){this.emit(p.default.Events.controlAIANSWER,this.body.node)},e.prototype.raiseHand=function(t){this.armAndHand[2].setLineVec(t)},e.prototype.raiseWeapom=function(t){this.weapom.setLineVec(t)},e.prototype.jumpMove=function(t){this.body.setLineVec(t)},e.prototype.attack=function(){this.energy>10?(this.energy-=10,this.weapom.attack()):"player"==this.type&&this.emit(c.EventType.UIEvent.showTip,"\u80fd\u91cf\u4e0d\u8db3")},e.prototype.beinjured=function(t){var e=this;if(t.type==this.type){if(this.emit(c.EventType.AudioEvent.playEffect,h.GlobalEnum.AudioClip.hit),this.life-=t.hurt,this.emit(c.EventType.SDKEvent.vibrateShort),this.life<0){this.life=0,this.head.die(),this.die();var o=cc.director.getScheduler();o.setTimeScale(.1),this.type==p.default.CollisType.player?setTimeout(function(){e.emit(c.EventType.PlayerEvent.death),o.setTimeScale(1)},3e3):this.type==p.default.CollisType.foe&&setTimeout(function(){e.emit(c.EventType.PlayerEvent.foeDeath),o.setTimeScale(1)},3e3)}if(console.log("\u6536\u5230\u4f24\u5bb3:"+t.hurt),this.emit(p.default.Events.setBar,{type:this.type,barType:"life",rate:this.life/this.MaxLife}),t.isCrit){var i=r.default.get("Crit",{hurt:t.hurt});this.critNode.addChild(i),i.setPosition(cc.v2(0,0))}this.head.toBig()}},e.prototype.setVector=function(t){0!=t.x||0!=t.y?(this.vector=t,t.len()>80?this.jumpFlag=!0:this.jumpFlag=!1):this.vector=null},e.prototype.dtUp=function(t){if(this.vector&&(this.weapom?this.raiseWeapom(this.vector):this.raiseHand(this.vector),this.jumpFlag)){var e=this.vector.x>0?1:-1;this.jumpMove(e)}this.energy<100?this.energy+=10*t:this.energy=100,this.emit(p.default.Events.setBar,{type:this.type,barType:"energy",rate:this.energy/100})},e.prototype.setToShow=function(){this.body.setStatic(),this.body.node.setPosition(cc.v2(0,0)),this.weapom},e.prototype.raiseWeapom2=function(){this.weapom.rigbody.type=cc.RigidBodyType.Static,this.weapom.node.setPosition(cc.v2(80,180)),this.weapom.node.angle=0,this.weapom.rigbody.syncPosition(!0),this.weapom.rigbody.syncRotation(!0)},a([y(cc.Node)],e.prototype,"critNode",void 0),a([d],e)}(l.default);o.default=v,cc._RF.pop()},{"../../Script/Common/GameData":void 0,"../../Script/Common/GlobalPool":void 0,"../../Script/GameSpecial/CollisComp":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GameOwn":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],ShowPlace:[function(t,e,o){"use strict";cc._RF.push(e,"5e0eacPOrxIIKkOECxmPWBM","ShowPlace");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/Action3dManager"),r=t("../../Script/Common/GameData"),l=t("../../Script/Common/GlobalPool"),c=t("../../Script/Common/Loader"),p=t("../../Script/Common/PlayerData"),h=t("../../Script/Common/yyComponent"),u=t("../../Script/GameSpecial/GameEventType"),d=t("../../Script/GameSpecial/GameOwn"),y=t("../../Script/GameSpecial/GlobalEnum"),v=t("./Role"),f=cc._decorator,m=f.ccclass,g=f.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerData=null,e.skinData=null,e.skinSprites={},e.content=null,e.roleShowScrs={},e.btnStartGame=null,e.onBuy=null,e.playVideo=null,e.initOver=!1,e.chooseSkin=null,e.attackBar=null,e.attackNum=null,e.attackBarLeng=0,e.lifeBar=null,e.lifeNum=null,e.lifeBarLeng=0,e.raritySpr=null,e.nameSpr=null,e.stars=[],e.halfStar=null,e.manNode=null,e.roleScr=null,e}return n(e,t),e.prototype.init=function(){this.initProgressBar(),this.onEvents(),this.initOver=!1},e.prototype.show=function(){this.node.active=!0,this.playerData||(this.playerData=p.default.getData("gameData"),this.chooseSkin=this.playerData[y.GlobalEnum.GoodsType.playerSkin].cur),this.skinData||(this.skinData=r.default.getData(y.GlobalEnum.GameDataType.skinData)),this.skinSprites.UL?this.showPlayer():this.loadAsset()},e.prototype.hide=function(){this.node.active=!1,this.roleScr&&(l.default.put(this.roleScr.node),this.roleScr=null)},e.prototype.loadAsset=function(){var t=this;c.default.loadBundle("LobbyUI",function(){c.default.loadBundleDir("LobbyUI","Image/roles",function(e){for(var o=e.length-1;o>=0;--o){var i=e[o];t.skinSprites[i.name]=i}c.default.loadBundleRes("LobbyUI","Prefab/RoleShow",function(e){e?l.default.createPool(e.name,e,e.name):console.log("roleshow\u52a0\u8f7d\u9519\u8bef"),c.default.loadBundle("LevelScene",function(){c.default.loadBundleDir("LevelScene","MultiplePrefab",function(e){for(var o=e.length-1;o>=0;--o){var i=e[o];l.default.createPool(i.name,i,i.name)}t.showPlayer()},cc.Prefab,!1)},!1,!1),t.continueShowRoles()},cc.Prefab,!1)},cc.SpriteFrame,!1)},!1,!1)},e.prototype.onEvents=function(){this.on(d.default.Events.chooseRole,this.chooseThis,this),this.on(d.default.Events.updateLobbyUI,this.updateUI,this)},e.prototype.chooseThis=function(t){"string"==typeof t&&(t=parseInt(t)),this.chooseSkin!=t&&(this.roleShowScrs[this.chooseSkin].noPitchOn(),this.chooseSkin=t,this.showPlayer())},e.prototype.updateUI=function(t){this.chooseThis(t),this.updateBtns()},e.prototype.continueShowRoles=function(){if(!this.initOver){var t=!1,e=!1,o=this.playerData[y.GlobalEnum.GoodsType.playerSkin].owned,i=this.chooseSkin;for(var n in this.skinData){var a=this.skinData[n],s=a.id+"_2";e=o.indexOf(a.id)>=0,t=i==a.id;var r={id:a.id,rarityImg:this.skinSprites[a.rarity],roleImg:this.skinSprites[s],own:e,using:t},c=l.default.get("RoleShow",r);this.content.addChild(c);var p=c.getComponent("RoleShow");this.roleShowScrs[p.id]=p}this.initOver=!0}},e.prototype.playBtnStartGame=function(){var t=.97;this.btnStartGame.setScale(t,t),t=1.03;var e=s.default.scaleTo(.5,t,t,t);t=.97;var o=s.default.scaleTo(.5,t,t,t),i=s.default.sequence(e,o),n=s.default.repeatForever(i);s.default.getMng(s.ActionMngType.UI).runAction(this.btnStartGame,n)},e.prototype.stopBtnStartGame=function(){s.default.getMng(s.ActionMngType.UI).stopAllActions(this.btnStartGame)},e.prototype.onBtnStartGame=function(){this.emit(u.EventType.AudioEvent.playClickBtn),this.setCurSkin(y.GlobalEnum.GoodsType.playerSkin,this.chooseSkin),this.emit(u.EventType.UIEvent.enter,y.GlobalEnum.UI.chooseLevel)},e.prototype.onBtnBuy=function(){this.emit(u.EventType.AudioEvent.playClickBtn);var t=p.default.getData("gameData.asset.gold"),e=r.default.getData(y.GlobalEnum.GameDataType.skinData,this.chooseSkin);"gold"==e.cost.type&&(t<e.cost.value?this.tipGoldUnenough():(this.subGold(e.cost.value),this.unlockSkin(y.GlobalEnum.GoodsType.playerSkin,this.chooseSkin),this.setCurSkin(y.GlobalEnum.GoodsType.playerSkin,this.chooseSkin),this.updateBtns()))},e.prototype.subGold=function(t){this.emit(u.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.asset.gold",value:t,mode:"-",save:!1,emit:!0})},e.prototype.unlockSkin=function(t,e){this.emit(u.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData."+t+".owned",value:parseInt(e),mode:"push",save:!1,emit:!1})},e.prototype.setCurSkin=function(t,e){this.emit(u.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData."+t+".cur",value:parseInt(e),mode:"=",save:!0,emit:!0})},e.prototype.tipGoldUnenough=function(){this.emit(u.EventType.UIEvent.showTip,"\u91d1\u5e01\u4e0d\u8db3")},e.prototype.onBtnVideo=function(){this.emit(u.EventType.AudioEvent.playClickBtn),this.emit(u.EventType.SDKEvent.showVideo,{success:this.getSkin.bind(this),quit:this.tryByVideoQuit.bind(this)})},e.prototype.getSkin=function(){this.unlockSkin(y.GlobalEnum.GoodsType.playerSkin,this.chooseSkin),this.setCurSkin(y.GlobalEnum.GoodsType.playerSkin,this.chooseSkin),this.updateBtns()},e.prototype.tryByVideoQuit=function(){this.emit(u.EventType.UIEvent.showTip,"\u89c2\u770b\u5b8c\u6574\u89c6\u9891\u624d\u80fd\u8bd5\u7528\u65b0\u76ae\u80a4\u54e6~~")},e.prototype.showEnterGame=function(){this.btnStartGame.active=!0,this.onBuy.active=!1,this.playVideo.active=!1,this.playBtnStartGame()},e.prototype.showGetSkin=function(){this.btnStartGame.active=!1,this.onBuy.active=!0,this.playVideo.active=!0,this.stopBtnStartGame()},e.prototype.justSignInGet=function(){this.btnStartGame.active=!1,this.onBuy.active=!1,this.playVideo.active=!1,this.stopBtnStartGame()},e.prototype.updateBtns=function(){this.playerData[y.GlobalEnum.GoodsType.playerSkin].owned.indexOf(this.chooseSkin)>=0?(this.roleShowScrs[this.chooseSkin].owned(),this.roleShowScrs[this.chooseSkin].pitchOn(),this.showEnterGame()):1004==this.chooseSkin||1008==this.chooseSkin?this.justSignInGet():this.showGetSkin()},e.prototype.initProgressBar=function(){0==this.attackBarLeng&&(this.attackBarLeng=this.attackBar.getComponent(cc.Sprite).spriteFrame.getOriginalSize().width),0==this.lifeBarLeng&&(this.lifeBarLeng=this.lifeBar.getComponent(cc.Sprite).spriteFrame.getOriginalSize().width),this.attackBar.width=1,this.lifeBar.width=1},e.prototype.onUpdateProgress=function(t,e){this.attackBar.width=this.attackBarLeng*(t/100),this.attackNum.string=t.toString(),this.lifeBar.width=this.lifeBarLeng*(e/3e3),this.lifeNum.string=e.toString()},e.prototype.showPlayer=function(){var t=r.default.getData(y.GlobalEnum.GameDataType.skinData,this.chooseSkin);this.onUpdateProgress(t.baseATK,t.baseHP);var e=t.rarity;this.raritySpr.spriteFrame=this.skinSprites[e],this.nameSpr.spriteFrame=this.skinSprites[t.id+"_0"],this.showRarity(e),this.showRole(),this.updateBtns()},e.prototype.showRarity=function(t){var e=0;"SSS"==t?e=5:"SS"==t?e=4.5:"S"==t?e=4:"A"==t?e=3.5:"B"==t&&(e=3),this.showStar(Math.floor(e)),Math.floor(e)<e?this.halfStar.active=!0:this.halfStar.active=!1},e.prototype.showStar=function(t){for(var e=0;e<this.stars.length;e++)this.stars[e].active=e<t},e.prototype.showRole=function(){var t="Role_"+this.chooseSkin,e=l.default.get(t);this.manNode.addChild(e),e.setPosition(cc.v2(0,0)),this.roleScr&&(l.default.put(this.roleScr.node),this.roleScr=null),this.roleScr=e.getComponent(v.default);var o=r.default.getData(y.GlobalEnum.GameDataType.skinData,this.chooseSkin);this.roleScr.setData({type:"UI",skinData:o})},a([g(cc.Node)],e.prototype,"content",void 0),a([g(cc.Node)],e.prototype,"btnStartGame",void 0),a([g(cc.Node)],e.prototype,"onBuy",void 0),a([g(cc.Node)],e.prototype,"playVideo",void 0),a([g(cc.Node)],e.prototype,"attackBar",void 0),a([g(cc.Label)],e.prototype,"attackNum",void 0),a([g(cc.Node)],e.prototype,"lifeBar",void 0),a([g(cc.Label)],e.prototype,"lifeNum",void 0),a([g(cc.Sprite)],e.prototype,"raritySpr",void 0),a([g(cc.Sprite)],e.prototype,"nameSpr",void 0),a([g([cc.Node])],e.prototype,"stars",void 0),a([g(cc.Node)],e.prototype,"halfStar",void 0),a([g(cc.Node)],e.prototype,"manNode",void 0),a([m],e)}(h.default);o.default=S,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/GameData":void 0,"../../Script/Common/GlobalPool":void 0,"../../Script/Common/Loader":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GameOwn":void 0,"../../Script/GameSpecial/GlobalEnum":void 0,"./Role":"Role"}],TipMessage:[function(t,e,o){"use strict";cc._RF.push(e,"fa03fEKcf5HdqLeM7wO+JGh","TipMessage");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,s=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(s=(a<3?n(s):a>3?n(e,o,s):n(e,o))||s);return a>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/yyComponent"),r=t("../../Script/Common/Action3dManager"),l=t("../../Script/GameSpecial/GameEventType"),c=cc._decorator,p=c.ccclass,h=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.msg=null,e.action=null,e}return n(e,t),e.prototype.init=function(){this.node=this.node;var t=r.default.delay(.01),e=r.default.fadeTo(0,255),o=r.default.delay(1),i=r.default.fadeTo(.5,0),n=r.default.callFun(this.onFadeOut,this),a=r.default.sequence(t,e,o,i,n);this.action=a,this.setMsg(""),this.onEvents()},e.prototype.onEvents=function(){this.on(l.EventType.UIEvent.showTip,this.show,this)},e.prototype.reset=function(){this.node.opacity=0},e.prototype.show=function(t){this.node.active=!0,this.reset(),this.setMsg(t),r.default.getMng(r.ActionMngType.UI).runAction(this.node,this.action)},e.prototype.hide=function(){this.node.active=!1},e.prototype.setMsg=function(t){this.msg.string=t},e.prototype.onFadeOut=function(){this.hide()},a([h(cc.Label)],e.prototype,"msg",void 0),a([p],e)}(s.default);o.default=u,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0}]},{},["GameDirector","GameLobby","LevelController","LoadingUI","PlayerAssetBar","Role","RoleShow","ShowPlace","TipMessage"]);