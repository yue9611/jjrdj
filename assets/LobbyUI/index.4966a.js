window.__require=function t(e,o,i){function n(r,s){if(!o[r]){if(!e[r]){var p=r.split("/");if(p=p[p.length-1],!e[p]){var c="function"==typeof __require&&__require;if(!s&&c)return c(p,!0);if(a)return a(p,!0);throw new Error("Cannot find module '"+r+"'")}r=p}var h=o[r]={exports:{}};e[r][0].call(h.exports,function(t){return n(e[r][1][t]||t)},h,h.exports,t,e,o,i)}return o[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<i.length;r++)n(i[r]);return n}({ChooseLevelUI:[function(t,e,o){"use strict";cc._RF.push(e,"f021amoMRJIF4MR+vKuWQ0/","ChooseLevelUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../Script/Common/Action3dManager"),s=t("../../Script/Common/GlobalPool"),p=t("../../Script/Common/Loader"),c=t("../../Script/Common/PlayerData"),h=t("../../Script/Common/yyComponent"),l=t("../../Script/GameSpecial/GameEventType"),u=t("../../Script/GameSpecial/GlobalEnum"),y=t("./LvBox"),d=cc._decorator,m=d.ccclass,v=d.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelRecords={},e.nowLv=1,e.maxLv=10,e.indexNum=[1,9,17],e.lastNode=null,e.nextNode=null,e.boxsS=[],e.boxsScr=[],e.touchMask=null,e.touchMaskCount=!1,e}return n(e,t),e.prototype.init=function(){this.touchMaskCount=!1,this.updateTMC(),this.onEvents()},e.prototype.reuse=function(){},e.prototype.unuse=function(){},e.prototype.show=function(){this.node.active=!0,this.emit(l.EventType.UIEvent.exit,u.GlobalEnum.UI.playerAssetBar),0!=this.boxsScr.length?this.setData():this.loadPrefab()},e.prototype.setData=function(){this.node.active=!0,this.nowLv=c.default.getData("gameData.curLevel"),this.maxLv=32,this.levelRecords=c.default.getData("gameData.levelRecords"),this.initIndexNum()},e.prototype.onEvents=function(){this.on(l.EventType.ChooseEvent.levelClose,this.levelClose,this),this.on(l.EventType.ChooseEvent.levelChoose,this.levelChoose,this)},e.prototype.offEvents=function(){this.on(l.EventType.ChooseEvent.levelClose,this.levelClose,this),this.on(l.EventType.ChooseEvent.levelChoose,this.levelChoose,this)},e.prototype.levelClose=function(){this.emit(l.EventType.UIEvent.showTip,"\u5173\u5361\u672a\u5f00\u653e"),console.log("\u5173\u5361\u672a\u5f00\u653e")},e.prototype.levelChoose=function(t){t>0&&t<=this.maxLv?(console.log("\u5173\u5361\u5b58\u5728\uff0c\u5c06\u8fdb\u5165\u5173\u5361"),this.emit(l.EventType.LevelEvent.choseLevelItem,t)):console.log("\u5173\u5361\u6682\u65f6\u672a\u51c6\u5907\u597d\uff0c\u8fdb\u5165\u5173\u5361\u5931\u8d25")},e.prototype.initIndexNum=function(){var t=8*Math.floor((this.nowLv-1)/8)+1;this.indexNum=[t-8,t,t+8],this.updateBoxs()},e.prototype.last=function(){this.onBtn(this.lastNode),this.indexNum[1]-this.indexNum[0]==8&&this.indexNum[0]>0?this.rightMove():(this.emit(l.EventType.UIEvent.showTip,"\u8fd9\u8fb9\u6ca1\u6709\u4e86"),console.log("\u65e0\u6548\u5173\u5361\u9875"))},e.prototype.next=function(){this.onBtn(this.nextNode),this.indexNum[2]-this.indexNum[1]==8&&this.indexNum[2]<=this.maxLv?this.leftMove():(this.emit(l.EventType.UIEvent.showTip,"\u8fd9\u8fb9\u6ca1\u6709\u4e86"),console.log("\u65e0\u6548\u5173\u5361\u9875"))},e.prototype.rightMove=function(){this.indexNum=[this.indexNum[0]-8,this.indexNum[0],this.indexNum[1]],this.boxsS=[this.boxsS[2],this.boxsS[0],this.boxsS[1]],this.boxsScr=[this.boxsScr[2],this.boxsScr[0],this.boxsScr[1]],this.updateBoxs()},e.prototype.leftMove=function(){this.indexNum=[this.indexNum[1],this.indexNum[2],this.indexNum[2]+8],this.boxsS=[this.boxsS[1],this.boxsS[2],this.boxsS[0]],this.boxsScr=[this.boxsScr[1],this.boxsScr[2],this.boxsScr[0]],this.updateBoxs()},e.prototype.initBoxsS=function(){if(!this.boxsScr[0]||!this.boxsScr[0][0])for(var t=0;t<this.boxsS.length;t++)for(var e=0;e<8;e++){var o=s.default.get("LvBox");this.boxsScr[t]||this.boxsScr.push([]),this.boxsS[t].addChild(o);var i=o.getComponent(y.default);this.boxsScr[t].push(i)}this.setData()},e.prototype.loadPrefab=function(){var t=this;p.default.loadBundle("LobbyUI",function(){p.default.loadBundleRes("LobbyUI","ChooseLevelUI/LvBox",function(e){s.default.createPool(e.name,e,e.name),t.initBoxsS()},cc.Prefab,!0)},!0,!0)},e.prototype.updateBoxs=function(){this.moveBoxS();for(var t=0;t<this.indexNum.length;t++)this.indexNum[t]>0&&this.indexNum[t]<=this.maxLv?this.updataBox(t):console.log("\u975e\u6cd5\u5173\u5361")},e.prototype.updateTMC=function(){this.touchMaskCount?(this.touchMask.active=!0,console.log("\u9632\u6b62\u8bef\u89e6\u5f00\u542f")):(this.touchMask.active=!1,console.log("\u9632\u6b62\u8bef\u89e6\u5173\u95ed"))},e.prototype.moveBoxS=function(){for(var t=r.default.getMng(r.ActionMngType.UI),e=0;e<this.boxsS.length;e++){var o=1e3*e-1e3,i=this.boxsS[e].getPosition(),n=1;Math.abs(i.x-o)>1500&&(n=0);var a=r.default.moveTo(n,o,i.y),s=r.default.callFun(this.boxMoved,this),p=r.default.sequence(a,s);t.runAction(this.boxsS[e],p),this.touchMaskCount=!0}this.updateTMC()},e.prototype.boxMoved=function(){this.touchMaskCount=!1,this.updateTMC()},e.prototype.updataBox=function(t){for(var e=this.indexNum[t],o=0;o<this.boxsScr[t].length;o++){var i=e+o;i>this.maxLv&&(i=999);var n=0,a=0;i<this.nowLv?(n=0,a=this.getStarNum(i)):i==this.nowLv?n=1:i>this.nowLv&&(n=2),this.boxsScr[t][o].setData({lv:i,openState:n,starNum:a})}},e.prototype.getStarNum=function(t){return this.levelRecords[t]?this.levelRecords[t]:0},e.prototype.onBtn=function(t){var e=.97;t.setScale(e,e),e=1.03;var o=r.default.scaleTo(.5,e,e,e);e=.97;var i=r.default.scaleTo(.5,e,e,e),n=r.default.sequence(o,i);r.default.getMng(r.ActionMngType.UI).runAction(t,n)},e.prototype.stopBtn=function(t){r.default.getMng(r.ActionMngType.UI).stopAllActions(t)},a([v(cc.Node)],e.prototype,"lastNode",void 0),a([v(cc.Node)],e.prototype,"nextNode",void 0),a([v([cc.Node])],e.prototype,"boxsS",void 0),a([v(cc.Node)],e.prototype,"touchMask",void 0),a([m],e)}(h.default);o.default=f,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/GlobalPool":void 0,"../../Script/Common/Loader":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0,"./LvBox":"LvBox"}],ConfigSettingUI:[function(t,e,o){"use strict";cc._RF.push(e,"5219a61WZBHrLPY3aPlPMyY","ConfigSettingUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../Script/Common/yyComponent"),s=t("../../Script/GameSpecial/GameConfig"),p=t("../../Script/GameSpecial/GameEventType"),c=t("../../Script/GameSpecial/GlobalEnum"),h=cc._decorator,l=h.ccclass,u=h.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.togBGM=null,e.togEffect=null,e.togVibrate=null,e}return n(e,t),e.prototype.initConfig=function(){var t=s.default.audioConfig;this.togBGM.isChecked=t.bgm,this.togEffect.isChecked=t.effect;var e=s.default.driveConfig;this.togVibrate.isChecked=e.vibrate},e.prototype.init=function(){this.initComponents(),this.initConfig()},e.prototype.show=function(){this.node.active||(this.node.active=!0,this.emit(p.EventType.DirectorEvent.pauseLevel),this.initConfig())},e.prototype.hide=function(){this.node.active&&(this.node.active=!1,this.emit(p.EventType.DirectorEvent.resumeLevel))},e.prototype.saveConfig=function(){var t={bgm:this.togBGM.isChecked,effect:this.togEffect.isChecked};s.default.audioConfig=t;var e={vibrate:this.togVibrate.isChecked};s.default.driveConfig=e},e.prototype.onBtnClose=function(){this.saveConfig(),this.emit(p.EventType.DirectorEvent.resumeLevel),this.emit(p.EventType.UIEvent.exit,c.GlobalEnum.UI.configSetting)},e.prototype.onCloseBGM=function(){this.togBGM.isChecked?this.emit(p.EventType.AudioEvent.playBGM,c.GlobalEnum.AudioClip.BGM):this.emit(p.EventType.AudioEvent.stopBGM)},a([u(cc.Toggle)],e.prototype,"togBGM",void 0),a([u(cc.Toggle)],e.prototype,"togEffect",void 0),a([u(cc.Toggle)],e.prototype,"togVibrate",void 0),a([l],e)}(r.default);o.default=y,cc._RF.pop()},{"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameConfig":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],LvBox:[function(t,e,o){"use strict";cc._RF.push(e,"f64e0wcvChKOb8O9LY6OK9p","LvBox");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../Script/Common/yyComponent"),s=t("../../Script/GameSpecial/GameEventType"),p=cc._decorator,c=p.ccclass,h=p.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=[],e.bgSpr=null,e.strLab=null,e.lv=999,e.openState=2,e.starNum=0,e.starNodes=[],e}return n(e,t),e.prototype.init=function(t){this.node.active=!1,t?this.setData(t):this.setData({lv:999,openState:2,starNum:0})},e.prototype.reuse=function(t){this.node.active=!1,t?this.setData(t):this.setData({lv:999,openState:2,starNum:0})},e.prototype.unuse=function(){this.node.active=!1,this.strLab.string=""},e.prototype.setData=function(t){this.lv=t.lv,this.strLab.string=this.lv.toString(),this.openState=t.openState,this.bgSpr.spriteFrame=this.bg[this.openState],this.setStar(t.starNum),999==this.lv?this.node.active=!1:this.node.active=!0},e.prototype.setStar=function(t){this.starNum=t;for(var e=0;e<this.starNodes.length;e++)e<this.starNum?this.starNodes[e].active=!0:this.starNodes[e].active=!1},e.prototype.onClick=function(){switch(this.openState){case 0:console.log("\u8fdb\u5165\u5df2\u901a\u5173\u5173\u5361,\u6ce8\u610f\u9053\u5177\u53ef\u80fd\u65e0\u6cd5\u83b7\u5f97"),this.emit(s.EventType.ChooseEvent.levelChoose,this.lv);break;case 1:console.log("\u8fdb\u5165\u5f53\u524d\u5173\u5361"),this.emit(s.EventType.ChooseEvent.levelChoose,this.lv);break;case 2:console.log("\u8fdb\u5165\u672a\u5f00\u542f\u5173\u5361\uff0c\u8fdb\u5165\u5931\u8d25\uff0c\u8bf7\u4f9d\u6b21\u901a\u5173\u3002"),this.emit(s.EventType.ChooseEvent.levelClose);break;default:console.log("\u53d1\u751f\u672a\u77e5\u9519\u8bef\uff0c\u5173\u5361\u9009\u62e9\u5931\u8d25\uff0c\u8bf7\u9009\u62e9\u5176\u4ed6\u5173\u5361"),this.emit(s.EventType.ChooseEvent.levelClose)}},a([h([cc.SpriteFrame])],e.prototype,"bg",void 0),a([h(cc.Sprite)],e.prototype,"bgSpr",void 0),a([h(cc.Label)],e.prototype,"strLab",void 0),a([h([cc.Node])],e.prototype,"starNodes",void 0),a([c],e)}(r.default);o.default=l,cc._RF.pop()},{"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0}],ShopItem:[function(t,e,o){"use strict";cc._RF.push(e,"5a631MrW1ZFcYMlXrLofj5W","ShopItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,s=t("../../Script/Common/yyComponent"),p=t("../../Script/Common/Loader"),c=t("../../Script/GameSpecial/GameEventType"),h=t("../../Script/Common/PlayerData"),l=t("../../Script/Common/GameData"),u=t("../../Script/GameSpecial/GlobalEnum"),y=cc._decorator,d=y.ccclass,m=y.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemSprite=null,e.LockMask=null,e._unclock=!1,e.btnImg=null,e.priceLabel=null,e.imgUsing=null,e.imgUnlock=null,e.imgNeedBuy=null,e.imgNeedTry=null,e.imgTrying=null,e.itemState=null,e}return n(e,t),Object.defineProperty(e.prototype,"unlock",{get:function(){return this._unclock},set:function(t){this._unclock=!!t,this.LockMask.active=!this._unclock,this.setImg(this.data.id,this._unclock)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemId",{get:function(){return this.data?this.data.id:null},enumerable:!1,configurable:!0}),e.prototype.setItemData=function(t){this.setData(t)},e.prototype.updateState=function(){this.setBtnState()},e.prototype.setData=function(t){var e=h.default.getData("gameData.PlayerSkin"),o=e.try==t||e.owned.indexOf(t)>=0;this.data={id:t,unlock:o},this.unlock=o,this.setBtnState()},e.prototype.setImg=function(t,e){var o=this,i=t+"_";i+=e?"1":"2",p.default.loadBundleRes("LobbyUI","Image/roleSelect",function(t){o.itemSprite.spriteFrame=t.getSpriteFrame(i)},cc.SpriteAtlas,!1)},e.prototype.setBtnState=function(){var t=l.default.getData(u.GlobalEnum.GoodsType.playerSkin,this.itemId),e=h.default.getCurSkinId(u.GlobalEnum.GoodsType.playerSkin),o=h.default.getData("gameData.PlayerSkin").owned;switch(this.itemId==e?this.itemState=r.using:o.indexOf(this.itemId)>=0?this.itemState=r.unlock:t.video?this.itemState=r.needTry:this.itemState=r.needBuy,this.priceLabel.node.active=!1,this.itemState){case r.needBuy:this.unlock=!1,this.btnImg.spriteFrame=this.imgNeedBuy,this.priceLabel.node.active=!0,this.priceLabel.string=t.price.toString();break;case r.needTry:this.unlock=!1,this.btnImg.spriteFrame=this.imgNeedTry;break;case r.using:this.unlock=!0,this.btnImg.spriteFrame=this.imgUsing;break;case r.unlock:this.unlock=!0,this.btnImg.spriteFrame=this.imgUnlock}},e.prototype.onBtnBuy=function(){switch(this.emit(c.EventType.AudioEvent.playClickBtn),this.itemState){case r.using:break;case r.unlock:this.chooseUse();break;case r.needBuy:this.chooseBuy();break;case r.needTry:this.chooseTry();break;case r.trying:}},e.prototype.chooseUse=function(){this.emit(c.EventType.ShopEvent.onBtnUse,this)},e.prototype.chooseBuy=function(){this.emit(c.EventType.ShopEvent.onBtnBuy,this)},e.prototype.chooseTry=function(){this.emit(c.EventType.ShopEvent.onBtnTry,this)},a([m(cc.Sprite)],e.prototype,"itemSprite",void 0),a([m(cc.Node)],e.prototype,"LockMask",void 0),a([m(cc.Sprite)],e.prototype,"btnImg",void 0),a([m(cc.Label)],e.prototype,"priceLabel",void 0),a([m(cc.SpriteFrame)],e.prototype,"imgUsing",void 0),a([m(cc.SpriteFrame)],e.prototype,"imgUnlock",void 0),a([m(cc.SpriteFrame)],e.prototype,"imgNeedBuy",void 0),a([m(cc.SpriteFrame)],e.prototype,"imgNeedTry",void 0),a([m(cc.SpriteFrame)],e.prototype,"imgTrying",void 0),a([d],e)}(s.default);o.default=v,function(t){t[t.using=0]="using",t[t.unlock=1]="unlock",t[t.needBuy=2]="needBuy",t[t.needTry=3]="needTry",t[t.trying=4]="trying"}(r||(r={})),cc._RF.pop()},{"../../Script/Common/GameData":void 0,"../../Script/Common/Loader":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],ShopUI:[function(t,e,o){"use strict";cc._RF.push(e,"f1146XD9dZL0oi7dzvFICfT","ShopUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../Script/Common/yyComponent"),s=t("../../Script/GameSpecial/GlobalEnum"),p=t("../../Script/GameSpecial/GameEventType"),c=t("../../Script/Common/GameData"),h=t("../../Script/Common/PlayerData"),l=t("./ShopItem"),u=cc._decorator,y=u.ccclass,d=u.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._uiType=s.GlobalEnum.UI.shop,e.itemLayer=null,e.itemPrefab=null,e.items=[],e}return n(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return this._uiType},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.initComponents(),this.onEvents()},e.prototype.onEvents=function(){},e.prototype.reset=function(){this.resetItem()},e.prototype.show=function(){this.node.active=!0,this.reset(),this.setData()},e.prototype.setData=function(){},e.prototype.hide=function(){this.reset(),this.node.active=!1},e.prototype.initItem=function(){this.curItemId=null,this.items=[],this.itemLayer.removeAllChildren();for(var t=1;t<=6;++t){var e=cc.instantiate(this.itemPrefab),o=e.getComponent(l.default);o.init(t),this.itemLayer.addChild(e),this.items.push(o)}},e.prototype.resetItem=function(){},e.prototype.updateBtns=function(){for(var t=this.items.length-1;t>=0;--t)this.items[t].updateState()},e.prototype.onBtnExit=function(){this.emit(p.EventType.AudioEvent.playClickBtn),this.emit(p.EventType.UIEvent.exit,this.uiType)},e.prototype.onBtnBuy=function(t){this.curItemId=t.itemId,this.emit(p.EventType.AudioEvent.playClickBtn);var e=h.default.getData("gameData.asset.gold"),o=c.default.getData(s.GlobalEnum.GoodsType.playerSkin,this.curItemId);e<o.price?this.tipGoldUnenough():(this.subGold(o.price),this.unlockSkin(s.GlobalEnum.GoodsType.playerSkin,this.curItemId),this.setCurSkin(s.GlobalEnum.GoodsType.playerSkin,this.curItemId),this.updateBtns(),this.playChooseEffect())},e.prototype.subGold=function(t){this.emit(p.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.asset.gold",value:t,mode:"-",save:!1,emit:!0})},e.prototype.unlockSkin=function(t,e){this.emit(p.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData."+t+".owned",value:parseInt(e),mode:"push",save:!1,emit:!1})},e.prototype.setCurSkin=function(t,e){this.emit(p.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData."+t+".cur",value:parseInt(e),mode:"=",save:!0,emit:!0})},e.prototype.tipGoldUnenough=function(){this.emit(p.EventType.UIEvent.showTip,"\u91d1\u5e01\u4e0d\u8db3")},e.prototype.onBtnVideo=function(t){this.curItemId=t.itemId,this.emit(p.EventType.AudioEvent.playClickBtn),this.emit(p.EventType.SDKEvent.showVideo,{success:this.tryByVideo.bind(this),quit:this.tryByVideoQuit.bind(this)})},e.prototype.tryByVideo=function(){this.unlockSkin(s.GlobalEnum.GoodsType.playerSkin,this.curItemId),this.setCurSkin(s.GlobalEnum.GoodsType.playerSkin,this.curItemId),this.updateBtns(),this.playChooseEffect()},e.prototype.tryByVideoQuit=function(){this.emit(p.EventType.UIEvent.showTip,"\u89c2\u770b\u5b8c\u6574\u89c6\u9891\u624d\u80fd\u8bd5\u7528\u65b0\u76ae\u80a4\u54e6~~")},e.prototype.onBtnChoose=function(t){this.emit(p.EventType.AudioEvent.playClickBtn),this.curItemId=t.itemId;var e=t.itemId;h.default.getData("gameData.PlayerSkin.owned").indexOf(e)>=0?(this.emit(p.EventType.PlayerDataEvent.trySkinEnd,s.GlobalEnum.GoodsType.playerSkin),this.emit(p.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.PlayerSkin.cur",value:e,mode:"=",save:!0,emit:!0})):this.emit(p.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.PlayerSkin.try",value:e,mode:"=",save:!0,emit:!0}),this.updateBtns(),this.playChooseEffect()},e.prototype.playChooseEffect=function(){},a([d(cc.Node)],e.prototype,"itemLayer",void 0),a([d(cc.Prefab)],e.prototype,"itemPrefab",void 0),a([y],e)}(r.default);o.default=m,cc._RF.pop()},{"../../Script/Common/GameData":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0,"./ShopItem":"ShopItem"}],SignInUI:[function(t,e,o){"use strict";cc._RF.push(e,"06151uAGF5DQo2CjELAc7f4","SignInUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../Script/Common/Action3dManager"),s=t("../../Script/Common/PlayerData"),p=t("../../Script/Common/yyComponent"),c=t("../../Script/GameSpecial/GameEventType"),h=t("../../Script/GameSpecial/GameOwn"),l=t("../../Script/GameSpecial/GlobalEnum"),u=cc._decorator,y=u.ccclass,d=u.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.signInAward={1:{type:"gold",value:1e3},2:{type:"role",value:1004},3:{type:"gold",value:1500},4:{type:"gold",value:2e3},5:{type:"gold",value:3e3},6:{type:"gold",value:4e3},7:{type:"role",value:1008}},e.nowDay=0,e.togEffect=null,e.signIned=[],e.signInBtn=null,e}return n(e,t),e.prototype.init=function(){this.initComponents()},e.prototype.reset=function(){this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.signIn.allDays",value:0,mode:"=",save:!0,emit:!0}),this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.signIn.lastDay",value:0,mode:"=",save:!0,emit:!0}),this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.asset.gold",value:0,mode:"=",save:!0,emit:!0}),this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.PlayerSkin.owned",value:[1001],mode:"=",save:!0,emit:!0})},e.prototype.show=function(){this.node.active=!0,this.emit(c.EventType.DirectorEvent.pauseLevel),this.initConfig(),this.setFinish()},e.prototype.hide=function(){this.node.active&&(this.node.active=!1,this.emit(c.EventType.DirectorEvent.resumeLevel))},e.prototype.initConfig=function(){this.togEffect.isChecked=!0;var t=s.default.getData("gameData.signIn");this.nowDay=t.allDays;var e=(new Date).getDate();7!=t.allDays&&t.lastDay!=e?this.signInBtn.interactable=!0:this.signInBtn.interactable=!1},e.prototype.onBtnClose=function(){this.emit(c.EventType.DirectorEvent.resumeLevel),this.emit(c.EventType.UIEvent.exit,l.GlobalEnum.UI.signIn)},e.prototype.setFinish=function(){for(var t=0;t<this.signIned.length;t++)t<this.nowDay?this.signIned[t].active=!0:this.signIned[t].active=!1},e.prototype.onSignInBtn=function(){this.emit(c.EventType.AudioEvent.playClickBtn),this.togEffect.isChecked?this.playVideo():this.signIn(1)},e.prototype.playVideo=function(){this.emit(c.EventType.SDKEvent.showVideo,{success:this.signIn.bind(this,2),quit:this.tryByVideoQuit.bind(this)})},e.prototype.signIn=function(t){var e=this.signInAward[this.nowDay+1];"gold"==e.type?this.getGold(t*e.value):"role"==e.type&&this.getRole(e.value),this.succeedSignIn(),this.updateBtns()},e.prototype.getGold=function(t){this.addGold(t)},e.prototype.getRole=function(t){this.unlockSkin(l.GlobalEnum.GoodsType.playerSkin,t),this.setCurSkin(l.GlobalEnum.GoodsType.playerSkin,t),this.emit(h.default.Events.updateLobbyUI,t)},e.prototype.tryByVideoQuit=function(){this.emit(c.EventType.UIEvent.showTip,"\u89c2\u770b\u5b8c\u6574\u89c6\u9891\u624d\u80fd\u53cc\u500d\u7b7e\u5230\u54e6~~~")},e.prototype.addGold=function(t){this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.asset.gold",value:t,mode:"+",save:!1,emit:!0})},e.prototype.unlockSkin=function(t,e){this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData."+t+".owned",value:parseInt(e),mode:"push",save:!1,emit:!1})},e.prototype.setCurSkin=function(t,e){this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData."+t+".cur",value:parseInt(e),mode:"=",save:!0,emit:!0})},e.prototype.succeedSignIn=function(){this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.signIn.allDays",value:1,mode:"+",save:!0,emit:!0}),this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.signIn.lastDay",value:(new Date).getDate(),mode:"=",save:!0,emit:!0})},e.prototype.updateBtns=function(){var t=s.default.getData("gameData.signIn"),e=(new Date).getDate();7==t.allDays||t.lastDay==e?this.signInBtn.interactable=!1:this.signInBtn.interactable=!0,this.nowDay=t.allDays,this.setFinish(),this.animaBtn()},e.prototype.animaBtn=function(){var t=this.signIned[this.nowDay-1];t.setScale(cc.v2(1.3,1.3));var e=r.default.scaleTo(.2,2,2),o=r.default.scaleTo(.3,1,1),i=r.default.sequence(e,o);r.default.getMng(r.ActionMngType.UI).runAction(t,i)},a([d(cc.Toggle)],e.prototype,"togEffect",void 0),a([d([cc.Node])],e.prototype,"signIned",void 0),a([d(cc.Button)],e.prototype,"signInBtn",void 0),a([y],e)}(p.default);o.default=m,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GameOwn":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],TouchBannerUI2:[function(t,e,o){"use strict";cc._RF.push(e,"01ceaQjPb1NBZ/h0cjR8mbe","TouchBannerUI2");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../MainScene/Script/Role"),s=t("../../Script/Common/Action3dManager"),p=t("../../Script/Common/GameData"),c=t("../../Script/Common/GameFlow"),h=t("../../Script/Common/GlobalPool"),l=t("../../Script/Common/yyComponent"),u=t("../../Script/GameSpecial/GameEventType"),y=t("../../Script/GameSpecial/GlobalEnum"),d=cc._decorator,m=d.ccclass,v=d.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bar=null,e.barTotalLength=0,e.progress=0,e.barBg=null,e.role=null,e.foe=null,e.player=null,e.lightings=[],e.attack=null,e.mask=null,e.tip=null,e.foeCamera=null,e.playerScr=null,e.foeScr=null,e.touchCount=0,e.zadanbidiankaiguan=null,e.targetProgress=0,e.bannerShowing=!1,e.visbale=0,e.bannerShowCount=0,e.timerBanner3=null,e.showLightingTag=!1,e.timeLight=0,e.cameraTag=!1,e}return n(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return y.GlobalEnum.UI.touchBanner2},enumerable:!1,configurable:!0}),e.prototype.init=function(t){this.initAnim(),this.initProgress(),this.randomTouchCount(t)},e.prototype.reset=function(){this.resetAnim(),this.resetProgress()},e.prototype.show=function(t){var e=this;this.visbale=t.config[y.GlobalEnum.RecommendFlowConfig.visible],console.log("\u5f00\u5173\u914d\u7f6e\uff1a",t),this.node.active=!0,this.reset(),this.randomTouchCount(t),this.zadanbidiankaiguan=t.config[y.GlobalEnum.GameFlowGlobalConfig.mustTouchBanner],this.role=t.data,setTimeout(function(){e.showAnima()},1e3)},e.prototype.hide=function(){this.off(u.EventType.SDKEvent.show,this.onShow,this),this.reset(),this.node.active=!1,this.playerScr&&(this.playerScr.node.destroy(),this.playerScr=null),this.foeScr&&(this.foeScr.node.destroy(),this.foeScr=null)},e.prototype.initProgress=function(){this.barBg.active=!1,this.barTotalLength=this.bar.getComponent(cc.Sprite).spriteFrame.getOriginalSize().width,this.progress=0,this.updateBarWidth()},e.prototype.resetProgress=function(){this.progress=0,this.updateBarWidth()},e.prototype.updateBarWidth=function(){var t=this.barTotalLength*(1-this.progress);t<1&&(t=1),this.bar.width=t},e.prototype.updateProgress=function(t){this.progress>.7?this.subProgress(1.5*t):this.progress>.4?this.subProgress(1.2*t):this.subProgress(1*t)},e.prototype.subProgress=function(t){this.progress-=t,this.progress<0&&(this.progress=0),this.updateBarWidth()},e.prototype.addProgress=function(t){this.barBg.active||(this.barBg.active=!0),this.progress+=t,this.progress>1&&(this.progress=1),this.updateBarWidth(),this.progress>=1&&(this.emit(u.EventType.UIEvent.touchBannerFinish),this.emit(u.EventType.UIEvent.exit,this.uiType))},e.prototype.initAnim=function(){this.mask.active=!0,this.tip.active=!1,this.player.active=!1,this.foe.active=!1,this.barBg.active=!1,this.initLighting()},e.prototype.resetAnim=function(){this.mask.active=!0,this.tip.active=!1,this.player.active=!1,this.foe.active=!1,this.barBg.active=!1,this.showLightingTag=!1,this.cameraTag=!1,this.initLighting()},e.prototype.showAnima=function(){this.showTip()},e.prototype.playAnim=function(){},e.prototype.showTip=function(){this.tip.setPosition(cc.v2(1e3,300)),this.tip.active=!0;var t=s.default.moveTo(.1,0,300),e=s.default.delay(.7),o=s.default.callFun(this.showRole,this),i=s.default.sequence(t,e,o);s.default.getMng(s.ActionMngType.UI).runAction(this.tip,i)},e.prototype.showRole=function(){var t=this.role.player,e=h.default.get(t);e.setPosition(cc.v2(0,0)),e.parent=this.player,this.playerScr=e.getComponent(r.default);var o=p.default.getData(y.GlobalEnum.GameDataType.skinData,1001);this.playerScr.setData({type:"UI",skinData:o}),this.playerScr.setWeapom(2001),this.playerScr.setToShow(),this.playerScr.raiseWeapom2();var i=this.role.foe,n=h.default.get(i);n.setPosition(cc.v2(0,0)),n.parent=this.foe,this.foeScr=n.getComponent(r.default);var a=p.default.getData(y.GlobalEnum.GameDataType.skinData,1001);this.foeScr.setData({type:"touchbannerfoe",skinData:a}),this.foeScr.setToShow(),this._showRole()},e.prototype._showRole=function(){this.foeCamera.zoomRatio=1,this.cameraTag=!0,this.mask.active=!1,this.showLightingTag=!0,this.player.active=!0,this.foe.active=!0},e.prototype.initLighting=function(){for(var t=0;t<this.lightings.length;t++)this.lightings[t].active=!1},e.prototype.showLighting=function(t){var e=this;void 0===t&&(t=2);for(var o=this.randomArr(t,this.lightings.length),i=0;i<this.lightings.length;i++){var n=o.indexOf(i);this.lightings[i].active=!(n<0)}setTimeout(function(){e.initLighting()},300)},e.prototype.randomArr=function(t,e){if(t>e)return null;for(var o=[],i=[],n=0;n<e;n++)o.push(n);for(;i.length!=t;)if(i.length>t)i.pop();else{var a=Math.floor(Math.random()*o.length);i.push(o.splice(a,1)[0])}return i},e.prototype.attackAnima=function(){var t=this.attack.children[0],e=cc.instantiate(t);this.attack.addChild(e),this.moveLevel(e)},e.prototype.moveLevel=function(t){t.active=!0;var e=s.default.moveTo(.05,400,0),o=s.default.callFun(this.nodeOver,this,t),i=s.default.sequence(e,o);s.default.getMng(s.ActionMngType.UI).runAction(t,i)},e.prototype.nodeOver=function(t){t.destroy(),this.foeRotate()},e.prototype.foeRotate=function(){this.emit(u.EventType.SDKEvent.vibrateShort);var t=s.default.rotateTo2d(.05,-15),e=s.default.rotateTo2d(.05,15),o=s.default.sequence(t,e);s.default.getMng(s.ActionMngType.UI).runAction(this.foe,o)},e.prototype.randomTouchCount=function(t){this.zadanType=c.default.getGlobalConfig("zadanshengjikaiguan")?2:1;var e=2,o=6;if(void 0!==t&&void 0!==t.config){var i=t.config[y.GlobalEnum.RecommendFlowConfig.touchBannerClickCount].split("-");e=parseInt(i[0]),o=parseInt(i[1])}this.touchCount=e+Math.floor(Math.random()*(o-e+.999)),this.targetProgress=.1*this.touchCount,console.log("targetProgress:",this.targetProgress),this.bannerShowing=!1,this.bannerShowCount=0},e.prototype.onBtnShot=function(){if(this.attackAnima(),this.addProgress(.3),this.visbale)switch(this.zadanType){case 1:this.zadan1();break;case 2:this.zadan2()}},e.prototype.zadan1=function(){if(!this.bannerShowing&&this.progress>=this.targetProgress){console.log("\u663e\u793abanner,",this.progress),this._showBanner(),this.bannerShowing=!0;var t=this.zadanbidiankaiguan;console.log("\u7838\u86cb\u5fc5\u70b9\u5f00\u5173: "+t),t&&1==t?(this.waitTouchBanner(),console.log("\u8fd8\u6ca1\u7ed3\u675f\uff0c\u5f97\u70b9\u51fbbanner\u624d\u53ef\u4ee5")):(this.autoHideBanner(),console.log("\u597d\u4e86\u7ee7\u7eed\u6e38\u620f\u5427"))}},e.prototype.autoHideBanner=function(){var t=this;setTimeout(function(){t.bannerShowing=!1,t._hideBanner(),t.emit(u.EventType.UIEvent.exit,t.uiType),t.emit(u.EventType.UIEvent.touchBannerFinish)},2e3)},e.prototype.waitTouchBanner=function(){var t=this;this.once(u.EventType.SDKEvent.show,this.onShow,this),setTimeout(function(){t._hideBanner(),t.bannerShowing=!1},2e3)},e.prototype.onShow=function(){this.node.activeInHierarchy&&(this.bannerShowing=!1,this._hideBanner(),null!==this.timerBanner3&&(clearTimeout(this.timerBanner3),this.timerBanner3=null),this.emit(u.EventType.UIEvent.exit,this.uiType),this.emit(u.EventType.UIEvent.touchBannerFinish))},e.prototype.zadan2=function(){if(!this.bannerShowing&&this.progress>=this.targetProgress)switch(this.bannerShowCount){case 0:this.showBanner1();break;case 1:this.showBanenr2()}},e.prototype.showBanner=function(){this._showBanner(),this.bannerShowing=!0,this.bannerShowCount++},e.prototype.showBanner1=function(){var t=this;this.showBanner(),this.once(u.EventType.SDKEvent.show,this.onShow,this),setTimeout(function(){t._hideBanner(),t.bannerShowing=!1},2e3),this.targetProgress=.01},e.prototype.showBanenr2=function(){var t=this;this.showBanner(),setTimeout(function(){t._hideBanner(),t.bannerShowing=!1},2e3),this.timerBanner3=setTimeout(this.showBanner3.bind(this),3e3)},e.prototype.showBanner3=function(){var t=this;this.node.activeInHierarchy&&(this.showBanner(),setTimeout(function(){t.bannerShowing=!1,t._hideBanner(),t.emit(u.EventType.UIEvent.exit,t.uiType),t.emit(u.EventType.UIEvent.touchBannerFinish)},2e3))},e.prototype._showBanner=function(){this.emit(u.EventType.SDKEvent.showBanner,{style:{horizontal:"right"}})},e.prototype._hideBanner=function(){this.emit(u.EventType.SDKEvent.hideBanner)},e.prototype._removeBanner=function(){this.emit(u.EventType.SDKEvent.hideBanner)},e.prototype.update=function(t){if(this.updateProgress(t),this.showLightingTag&&(this.timeLight+=t,this.timeLight>1.5)){this.timeLight=0;var e=Math.floor(4*Math.random());this.showLighting(e)}this.cameraTag&&(this.foeCamera.zoomRatio<1.5?this.foeCamera.zoomRatio+=.5*t:this.cameraTag=!1)},a([v(cc.Node)],e.prototype,"bar",void 0),a([v(cc.Node)],e.prototype,"barBg",void 0),a([v(cc.Node)],e.prototype,"foe",void 0),a([v(cc.Node)],e.prototype,"player",void 0),a([v([cc.Node])],e.prototype,"lightings",void 0),a([v(cc.Node)],e.prototype,"attack",void 0),a([v(cc.Node)],e.prototype,"mask",void 0),a([v(cc.Node)],e.prototype,"tip",void 0),a([v(cc.Camera)],e.prototype,"foeCamera",void 0),a([m],e)}(l.default);o.default=f,cc._RF.pop()},{"../../MainScene/Script/Role":void 0,"../../Script/Common/Action3dManager":void 0,"../../Script/Common/GameData":void 0,"../../Script/Common/GameFlow":void 0,"../../Script/Common/GlobalPool":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],TouchBannerUI:[function(t,e,o){"use strict";cc._RF.push(e,"6746aKOT7lHLZEiPuMTWQ+O","TouchBannerUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../Script/Common/Action3dManager"),s=t("../../Script/Common/GameFlow"),p=t("../../Script/Common/yyComponent"),c=t("../../Script/GameSpecial/GameEventType"),h=t("../../Script/GameSpecial/GlobalEnum"),l=cc._decorator,u=l.ccclass,y=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bar=null,e.barTotalLength=0,e.progress=0,e.box=null,e.boxPlaying=!1,e.originalY=100,e.targetY=150,e.touchCount=0,e.zadanbidiankaiguan=null,e.targetProgress=0,e.bannerShowing=!1,e.bannerShowCount=0,e.timerBanner3=null,e}return n(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return h.GlobalEnum.UI.touchBanner},enumerable:!1,configurable:!0}),e.prototype.init=function(t){this.initAnim(),this.initProgress(),this.randomTouchCount(t)},e.prototype.reset=function(){this.resetAnim(),this.resetProgress()},e.prototype.show=function(t){console.log("\u5f00\u5173\u914d\u7f6e\uff1a",t),this.node.active=!0,this.reset(),this.randomTouchCount(t),this.zadanbidiankaiguan=t.config[h.GlobalEnum.GameFlowGlobalConfig.mustTouchBanner]},e.prototype.hide=function(){this.off(c.EventType.SDKEvent.show,this.onShow,this),this.reset(),this.node.active=!1},e.prototype.initProgress=function(){this.barTotalLength=this.bar.getComponent(cc.Sprite).spriteFrame.getOriginalSize().width,this.progress=0,this.updateBarWidth()},e.prototype.resetProgress=function(){this.progress=0,this.updateBarWidth()},e.prototype.updateBarWidth=function(){var t=this.barTotalLength*this.progress;t<1&&(t=1),this.bar.width=t},e.prototype.updateProgress=function(t){this.progress>.7?this.subProgress(1.5*t):this.progress>.4?this.subProgress(1.2*t):this.subProgress(1*t)},e.prototype.subProgress=function(t){this.progress-=t,this.progress<0&&(this.progress=0),this.updateBarWidth()},e.prototype.addProgress=function(t){this.progress+=t,this.progress>1&&(this.progress=1),this.updateBarWidth(),this.progress>=1&&(this.emit(c.EventType.UIEvent.touchBannerFinish),this.emit(c.EventType.UIEvent.exit,this.uiType))},e.prototype.initAnim=function(){this.boxPlaying=!1,this.box.setPosition(0,this.originalY)},e.prototype.resetAnim=function(){r.default.getMng(r.ActionMngType.UI).stopAllActions(this.box),this.boxPlaying=!1,this.box.setPosition(0,this.originalY)},e.prototype.playAnim=function(){this.clickBox()},e.prototype.clickBox=function(){this.boxPlaying=!0;var t=r.default.moveTo(.1,0,this.targetY,0),e=r.default.moveTo(.1,0,this.originalY,0),o=r.default.callFun(this.onBoxAnimFinish,this),i=r.default.sequence(t,e,o);r.default.getMng(r.ActionMngType.UI).runAction(this.box,i)},e.prototype.onBoxAnimFinish=function(){this.boxPlaying=!1},e.prototype.randomTouchCount=function(t){this.zadanType=s.default.getGlobalConfig("zadanshengjikaiguan")?2:1;var e=2,o=6;if(void 0!==t&&void 0!==t.config){var i=t.config[h.GlobalEnum.RecommendFlowConfig.touchBannerClickCount].split("-");e=parseInt(i[0]),o=parseInt(i[1])}this.touchCount=e+Math.floor(Math.random()*(o-e+.999)),this.targetProgress=.1*this.touchCount,console.log("targetProgress:",this.targetProgress),this.bannerShowing=!1,this.bannerShowCount=0},e.prototype.onBtnShot=function(){switch(this.addProgress(.3),this.playAnim(),this.zadanType){case 1:this.zadan1();break;case 2:this.zadan2()}},e.prototype.zadan1=function(){if(!this.bannerShowing&&this.progress>=this.targetProgress){console.log("\u663e\u793abanner,",this.progress),this._showBanner(),this.bannerShowing=!0;var t=this.zadanbidiankaiguan;console.log("\u7838\u86cb\u5fc5\u70b9\u5f00\u5173: "+t),t&&1==t?(this.waitTouchBanner(),console.log("\u8fd8\u6ca1\u7ed3\u675f\uff0c\u5f97\u70b9\u51fbbanner\u624d\u53ef\u4ee5")):(this.autoHideBanner(),console.log("\u597d\u4e86\u7ee7\u7eed\u6e38\u620f\u5427"))}},e.prototype.autoHideBanner=function(){var t=this;setTimeout(function(){t.bannerShowing=!1,t._hideBanner(),t.emit(c.EventType.UIEvent.exit,t.uiType),t.emit(c.EventType.UIEvent.touchBannerFinish)},2e3)},e.prototype.waitTouchBanner=function(){var t=this;this.once(c.EventType.SDKEvent.show,this.onShow,this),setTimeout(function(){t._hideBanner(),t.bannerShowing=!1},2e3)},e.prototype.onShow=function(){this.node.activeInHierarchy&&(this.bannerShowing=!1,this._hideBanner(),null!==this.timerBanner3&&(clearTimeout(this.timerBanner3),this.timerBanner3=null),this.emit(c.EventType.UIEvent.exit,this.uiType),this.emit(c.EventType.UIEvent.touchBannerFinish))},e.prototype.zadan2=function(){if(!this.bannerShowing&&this.progress>=this.targetProgress)switch(this.bannerShowCount){case 0:this.showBanner1();break;case 1:this.showBanenr2()}},e.prototype.showBanner=function(){this._showBanner(),this.bannerShowing=!0,this.bannerShowCount++},e.prototype.showBanner1=function(){var t=this;this.showBanner(),this.once(c.EventType.SDKEvent.show,this.onShow,this),setTimeout(function(){t._hideBanner(),t.bannerShowing=!1},2e3),this.targetProgress=.01},e.prototype.showBanenr2=function(){var t=this;this.showBanner(),setTimeout(function(){t._hideBanner(),t.bannerShowing=!1},2e3),this.timerBanner3=setTimeout(this.showBanner3.bind(this),3e3)},e.prototype.showBanner3=function(){var t=this;this.node.activeInHierarchy&&(this.showBanner(),setTimeout(function(){t.bannerShowing=!1,t._hideBanner(),t.emit(c.EventType.UIEvent.exit,t.uiType),t.emit(c.EventType.UIEvent.touchBannerFinish)},2e3))},e.prototype._showBanner=function(){this.emit(c.EventType.SDKEvent.showBanner,{style:{horizontal:"middle"}})},e.prototype._hideBanner=function(){this.emit(c.EventType.SDKEvent.hideBanner)},e.prototype._removeBanner=function(){this.emit(c.EventType.SDKEvent.hideBanner)},e.prototype.update=function(t){this.updateProgress(t)},a([y(cc.Node)],e.prototype,"bar",void 0),a([y(cc.Node)],e.prototype,"box",void 0),a([u],e)}(p.default);o.default=d,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/GameFlow":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],TrySkinUI:[function(t,e,o){"use strict";cc._RF.push(e,"c4ef23QiN9Pwrm5PL9S0P9a","TrySkinUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../Script/Common/Action3dManager"),s=t("../../Script/Common/GameData"),p=t("../../Script/Common/GlobalPool"),c=t("../../Script/Common/PlayerData"),h=t("../../Script/Common/yyComponent"),l=t("../../Script/GameSpecial/AdConfig"),u=t("../../Script/GameSpecial/CollisComp"),y=t("../../Script/GameSpecial/GameEventType"),d=t("../../Script/GameSpecial/GameOwn"),m=t("../../Script/GameSpecial/GlobalEnum"),v=cc._decorator,f=v.ccclass,g=v.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._uiType=m.GlobalEnum.UI.trySkin,e.type=null,e.tryId=null,e.chooseArray=[],e.weapomTip=null,e.skinTip=null,e.roleNode=null,e.weapomNode=null,e.roleScr=null,e.light1=null,e.light2=null,e}return n(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return this._uiType},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.node.active=!0,this.randomShow()},e.prototype.reuse=function(){},e.prototype.unuse=function(){},e.prototype.show=function(){this.node.active=!0,this.randomShow()},e.prototype.hide=function(){this.node.active=!1,this.stopLight(),this.emit(y.EventType.UIEvent.exit,m.GlobalEnum.UI.playerAssetBar)},e.prototype.setData=function(){},e.prototype.randomShow=function(){this.chooseArray=[];var t=s.default.getData(m.GlobalEnum.GameDataType.skinData),e=c.default.getData("gameData.PlayerSkin.owned"),o=s.default.getData(m.GlobalEnum.GameDataType.WeapomData),i=c.default.getData("gameData.PlayerWeapom.owned");for(var n in t)e.indexOf(parseInt(n))<0&&this.chooseArray.push(t[n].id);for(var n in o)i.indexOf(parseInt(n))<0&&this.chooseArray.push(o[n].id);if(this.chooseArray.length<=0)this._startGame();else{var a=Math.floor(Math.random()*this.chooseArray.length);this.tryId=this.chooseArray[a],this.showSpr()}},e.prototype.showSpr=function(){var t,e=null;this.tryId>2e3?(t="Weapom_"+this.tryId,this.weapomTip.active=!0,this.skinTip.active=!1,e=p.default.get(t),this.weapomNode.addChild(e)):(t="Role_"+this.tryId,this.weapomTip.active=!1,this.skinTip.active=!0,e=p.default.get(t),this.roleNode.addChild(e)),e.setPosition(cc.v2(0,0)),this.roleScr&&p.default.put(this.roleScr.node),this.roleScr=e.getComponent(u.default);var o=s.default.getData(m.GlobalEnum.GameDataType.skinData,this.tryId);this.roleScr.setData({type:"UI",skinData:o}),this.lightPlay()},e.prototype.lightPlay=function(){var t=r.default.rotateBy2d(4,360),e=r.default.repeatForever(t),o=r.default.rotateBy2d(4,-360),i=r.default.repeatForever(o),n=r.default.getMng(r.ActionMngType.UI);n.runAction(this.light1,e),n.runAction(this.light2,i)},e.prototype.stopLight=function(){var t=r.default.getMng(r.ActionMngType.UI);t.stopAllActions(this.light1),t.stopAllActions(this.light2)},e.prototype.onBtnVideo=function(){this.emit(y.EventType.AudioEvent.playClickBtn),this.emit(y.EventType.SDKEvent.showVideo,{success:this.videoSuccess.bind(this),quit:this.VideoQuit.bind(this)})},e.prototype.videoSuccess=function(){this.addPorp()},e.prototype.VideoQuit=function(){this.emit(y.EventType.UIEvent.showTip,"\u89c2\u770b\u5b8c\u6574\u89c6\u9891\u624d\u80fd\u83b7\u5f97\u9053\u5177~~")},e.prototype.addPorp=function(){this.tryId>2e3?this.emit(y.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.PlayerWeapom.try",value:this.tryId,mode:"=",save:!0,emit:!0}):this.emit(y.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.PlayerSkin.try",value:this.tryId,mode:"=",save:!0,emit:!0}),this._startGame()},e.prototype.onBtnStartGame=function(){this.emit(y.EventType.AudioEvent.playClickBtn),this._startGame()},e.prototype._startGame=function(){this.emit(d.default.Events.trySkinOver),this.emit(y.EventType.UIEvent.exit,this._uiType),this.hide()},e.prototype.showBanner=function(){this.emit(y.EventType.SDKEvent.showBanner,{id:l.AdConfig.bannerID.gameScene,style:{horizontal:"middle",width:750}})},a([g(cc.Node)],e.prototype,"weapomTip",void 0),a([g(cc.Node)],e.prototype,"skinTip",void 0),a([g(cc.Node)],e.prototype,"roleNode",void 0),a([g(cc.Node)],e.prototype,"weapomNode",void 0),a([g(cc.Node)],e.prototype,"light1",void 0),a([g(cc.Node)],e.prototype,"light2",void 0),a([f],e)}(h.default);o.default=S,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/GameData":void 0,"../../Script/Common/GlobalPool":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/AdConfig":void 0,"../../Script/GameSpecial/CollisComp":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GameOwn":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}]},{},["ChooseLevelUI","LvBox","ConfigSettingUI","ShopItem","ShopUI","SignInUI","TouchBannerUI2","TouchBannerUI","TrySkinUI"]);